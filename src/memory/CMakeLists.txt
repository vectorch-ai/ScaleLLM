include(cc_library)
include(cc_test)

cc_library(
  NAME 
    memory
  HDRS 
    memory.h
    kv_cache.h
    block.h
    block_allocator.h
    block_manager.h
    prefix_cache.h
  SRCS 
    memory.cpp
    kv_cache.cpp
    block.cpp
    block_allocator.cpp
    block_manager.cpp
    prefix_cache.cpp
  DEPS
    :kernels
    :request
    glog::glog
    torch
)

cc_test(
  NAME
    memory_test
  SRCS
    kv_cache_test.cpp
    prefix_cache_test.cpp
    block_allocator_test.cpp
    block_manager_test.cpp
  DEPS
    :memory
    absl::random_random
    :gtest_main
)

include(cc_library)
include(cc_test)

cc_library(
  NAME
    gemm.kernels
  INCLUDES
    ${CMAKE_CURRENT_SOURCE_DIR}
  HDRS
    collective/sm80_collective_grouped_gemm.cuh
    collective/sm80_collective_epilogue.cuh
    device/sm80_grouped_gemm_launch.cuh
    common/tile_scheduler.cuh
  DEPS
    cutlass
)

cc_test(
  NAME
    tile_scheduler_test
  INCLUDES
    ${CMAKE_CURRENT_SOURCE_DIR}
  SRCS
    tests/tile_scheduler_test.cu
  DEPS
    :gtest_main
    absl::random_random
    cutlass
)

cc_test(
  NAME
    gemm_kernel_test
  INCLUDES
    ${CMAKE_CURRENT_SOURCE_DIR}
  SRCS
    tests/sm80_grouped_gemm_test.cu
  DEPS
    :gemm.kernels
    :gtest_main
    absl::random_random
    torch
)

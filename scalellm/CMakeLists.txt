include(pybind_extension)

pybind_extension(
  NAME
    _C
  COPTS
    -DPY_MODULE_NAME=_C
  SRCS
    csrc/sampling_params.cpp
    csrc/output.cpp
    csrc/llm_handler.cpp
    csrc/module.cpp
    csrc/kernels.cu
  DEFINES 
    PYBIND11_DETAILED_ERROR_MESSAGES=1
  LINKDIRS
    ${TORCH_INSTALL_PREFIX}/lib
  DEPS
    :llm_handler
    :marlin.kernels
    :flash_infer.kernels
    torch
    torch_python
    absl::strings
    gflags::gflags
    glog::glog
    Python::Module
)
